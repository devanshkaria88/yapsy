{"openapi":"3.0.0","paths":{"/api/v1/mobile/auth/firebase":{"post":{"description":"Exchange a Firebase ID token (from Google/Apple sign-in) for backend JWT tokens. Creates a new user on first login.","operationId":"mobile_AuthController_firebaseAuth","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FirebaseAuthDto"}}}},"responses":{"201":{"description":"Auth successful","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponseDto"}}}},"401":{"description":"Invalid or expired Firebase token"}},"security":[{"mobile-jwt":[]}],"summary":"Authenticate with Firebase","tags":["Auth"]}},"/api/v1/mobile/auth/onboard":{"post":{"description":"Submit name, date of birth, and gender after first sign-in. Sets is_onboarded to true.","operationId":"mobile_AuthController_onboard","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OnboardingDto"}}}},"responses":{"201":{"description":"Onboarding completed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthUserDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Complete onboarding","tags":["Auth"]}},"/api/v1/mobile/auth/refresh":{"post":{"description":"Exchange a valid refresh token for a new token pair.","operationId":"mobile_AuthController_refresh","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenDto"}}}},"responses":{"201":{"description":"Tokens refreshed","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponseDto"}}}},"401":{"description":"Invalid refresh token"}},"security":[{"mobile-jwt":[]}],"summary":"Refresh access token","tags":["Auth"]}},"/api/v1/mobile/auth/logout":{"post":{"operationId":"mobile_AuthController_logout","parameters":[],"responses":{"201":{"description":"Logged out successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Logout and invalidate refresh token","tags":["Auth"]}},"/api/v1/mobile/users/me":{"get":{"operationId":"mobile_UsersController_getProfile","parameters":[],"responses":{"200":{"description":"User profile returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserProfileResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get current user profile","tags":["Users"]},"patch":{"operationId":"mobile_UsersController_updateProfile","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateUserDto"}}}},"responses":{"200":{"description":"Profile updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserProfileResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Update current user profile","tags":["Users"]},"delete":{"operationId":"mobile_UsersController_deleteAccount","parameters":[],"responses":{"200":{"description":"Account deleted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Delete account (soft delete)","tags":["Users"]}},"/api/v1/mobile/users/me/fcm-token":{"patch":{"operationId":"mobile_UsersController_updateFcmToken","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateFcmTokenDto"}}}},"responses":{"200":{"description":"FCM token updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Update FCM token for push notifications","tags":["Users"]}},"/api/v1/mobile/tasks":{"post":{"operationId":"mobile_TasksController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateTaskDto"}}}},"responses":{"200":{"description":"Task created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Create a new task","tags":["Tasks"]},"get":{"operationId":"mobile_TasksController_findAll","parameters":[{"name":"page","required":false,"in":"query","schema":{"minimum":1,"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","schema":{"minimum":1,"maximum":100,"default":20,"type":"number"}},{"name":"date","required":false,"in":"query","description":"Filter by specific date","schema":{"example":"2026-02-20","type":"string"}},{"name":"status","required":false,"in":"query","schema":{"type":"string","enum":["pending","completed","rolled_over","cancelled"]}},{"name":"from","required":false,"in":"query","description":"Start date for range filter","schema":{"example":"2026-02-01","type":"string"}},{"name":"to","required":false,"in":"query","description":"End date for range filter","schema":{"example":"2026-02-28","type":"string"}},{"name":"priority","required":false,"in":"query","schema":{"type":"string","enum":["low","medium","high"]}}],"responses":{"200":{"description":"Tasks returned successfully","content":{"application/json":{"schema":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/TaskResponseDto"}},"meta":{"type":"object","properties":{"page":{"type":"number","example":1},"limit":{"type":"number","example":20},"total":{"type":"number","example":42},"hasMore":{"type":"boolean","example":true}}}}}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get all tasks with pagination and filters","tags":["Tasks"]}},"/api/v1/mobile/tasks/today":{"get":{"operationId":"mobile_TasksController_findToday","parameters":[],"responses":{"200":{"description":"Today's tasks returned successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskResponseDto"}}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get tasks for today","tags":["Tasks"]}},"/api/v1/mobile/tasks/overdue":{"get":{"operationId":"mobile_TasksController_findOverdue","parameters":[],"responses":{"200":{"description":"Overdue tasks returned successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskResponseDto"}}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get overdue pending tasks","tags":["Tasks"]}},"/api/v1/mobile/tasks/upcoming":{"get":{"operationId":"mobile_TasksController_findUpcoming","parameters":[],"responses":{"200":{"description":"Upcoming tasks returned successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskResponseDto"}}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get upcoming tasks (next 14 days)","tags":["Tasks"]}},"/api/v1/mobile/tasks/calendar/{year}/{month}":{"get":{"operationId":"mobile_TasksController_findCalendarMonth","parameters":[{"name":"year","required":true,"in":"path","description":"Year (e.g. 2026)","schema":{"type":"number"}},{"name":"month","required":true,"in":"path","description":"Month (1-12)","schema":{"type":"number"}}],"responses":{"200":{"description":"Calendar tasks returned successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TaskResponseDto"}}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get tasks for a calendar month","tags":["Tasks"]}},"/api/v1/mobile/tasks/{id}":{"get":{"operationId":"mobile_TasksController_findOne","parameters":[{"name":"id","required":true,"in":"path","description":"Task ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Task returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"Task not found"}},"security":[{"mobile-jwt":[]}],"summary":"Get a task by ID","tags":["Tasks"]},"patch":{"operationId":"mobile_TasksController_update","parameters":[{"name":"id","required":true,"in":"path","description":"Task ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateTaskDto"}}}},"responses":{"200":{"description":"Task updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"Task not found"}},"security":[{"mobile-jwt":[]}],"summary":"Update a task","tags":["Tasks"]},"delete":{"operationId":"mobile_TasksController_remove","parameters":[{"name":"id","required":true,"in":"path","description":"Task ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Task deleted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"Task not found"}},"security":[{"mobile-jwt":[]}],"summary":"Delete a task (soft delete)","tags":["Tasks"]}},"/api/v1/mobile/tasks/{id}/complete":{"patch":{"operationId":"mobile_TasksController_complete","parameters":[{"name":"id","required":true,"in":"path","description":"Task ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Task completed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"Task not found"}},"security":[{"mobile-jwt":[]}],"summary":"Mark a task as completed","tags":["Tasks"]}},"/api/v1/mobile/tasks/{id}/rollover":{"post":{"operationId":"mobile_TasksController_rollover","parameters":[{"name":"id","required":true,"in":"path","description":"Task ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RolloverTaskDto"}}}},"responses":{"200":{"description":"Task rolled over successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TaskResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"Task not found"}},"security":[{"mobile-jwt":[]}],"summary":"Roll over a task to a new date","tags":["Tasks"]}},"/api/v1/mobile/notes":{"get":{"operationId":"mobile_NotesController_findAll","parameters":[{"name":"page","required":false,"in":"query","schema":{"minimum":1,"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","schema":{"minimum":1,"maximum":100,"default":20,"type":"number"}},{"name":"is_resolved","required":false,"in":"query","description":"Filter by resolved status","schema":{"type":"boolean"}},{"name":"source","required":false,"in":"query","description":"Filter by source","schema":{"type":"string","enum":["voice","manual"]}}],"responses":{"200":{"description":"Notes returned successfully","content":{"application/json":{"schema":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/NoteResponseDto"}},"meta":{"type":"object","properties":{"page":{"type":"number","example":1},"limit":{"type":"number","example":20},"total":{"type":"number","example":42},"hasMore":{"type":"boolean","example":true}}}}}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get all notes with pagination and filters","tags":["Notes"]},"post":{"operationId":"mobile_NotesController_create","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateNoteDto"}}}},"responses":{"201":{"description":"Note created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NoteResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Create a new note","tags":["Notes"]}},"/api/v1/mobile/notes/{id}":{"patch":{"operationId":"mobile_NotesController_update","parameters":[{"name":"id","required":true,"in":"path","description":"Note ID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateNoteDto"}}}},"responses":{"200":{"description":"Note updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/NoteResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"Note not found"}},"security":[{"mobile-jwt":[]}],"summary":"Update a note","tags":["Notes"]},"delete":{"operationId":"mobile_NotesController_remove","parameters":[{"name":"id","required":true,"in":"path","description":"Note ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Note deleted successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"Note not found"}},"security":[{"mobile-jwt":[]}],"summary":"Delete a note","tags":["Notes"]}},"/api/v1/mobile/conversations/prepare":{"get":{"operationId":"mobile_ConversationsController_prepare","parameters":[],"responses":{"200":{"description":"Session prepared successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PrepareSessionResponseDto"}}}},"401":{"description":"Unauthorized"},"402":{"description":"Weekly limit reached (free tier)"}},"security":[{"mobile-jwt":[]}],"summary":"Prepare a voice session (signed URL + config)","tags":["Conversations"]}},"/api/v1/mobile/conversations":{"post":{"operationId":"mobile_ConversationsController_saveConversation","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SaveConversationDto"}}}},"responses":{"201":{"description":"Conversation saved, journal created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JournalResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Save a conversation and create journal entry","tags":["Conversations"]}},"/api/v1/mobile/conversations/{id}/status":{"get":{"operationId":"mobile_ConversationsController_getProcessingStatus","parameters":[{"name":"id","required":true,"in":"path","description":"Journal ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Processing status returned","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProcessingStatusResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"Journal not found"}},"security":[{"mobile-jwt":[]}],"summary":"Get journal processing status","tags":["Conversations"]}},"/api/v1/mobile/journals":{"get":{"operationId":"mobile_JournalsController_findAll","parameters":[{"name":"page","required":false,"in":"query","schema":{"minimum":1,"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","schema":{"minimum":1,"maximum":100,"default":20,"type":"number"}},{"name":"from","required":false,"in":"query","description":"Filter from date","schema":{"example":"2026-02-01","type":"string"}},{"name":"to","required":false,"in":"query","description":"Filter to date","schema":{"example":"2026-02-15","type":"string"}}],"responses":{"200":{"description":"Journals returned successfully","content":{"application/json":{"schema":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/JournalResponseDto"}},"meta":{"type":"object","properties":{"page":{"type":"number","example":1},"limit":{"type":"number","example":20},"total":{"type":"number","example":42},"hasMore":{"type":"boolean","example":true}}}}}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get all journals with pagination and date filters","tags":["Journals"]}},"/api/v1/mobile/journals/today":{"get":{"operationId":"mobile_JournalsController_findToday","parameters":[],"responses":{"200":{"description":"Today's journal returned","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JournalResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get journal for today","tags":["Journals"]}},"/api/v1/mobile/journals/stats":{"get":{"operationId":"mobile_JournalsController_findStats","parameters":[{"name":"days","required":false,"in":"query","description":"Number of days for stats","schema":{"minimum":7,"maximum":90,"default":30,"type":"number"}}],"responses":{"200":{"description":"Stats returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JournalStatsResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get journal stats for last N days","tags":["Journals"]}},"/api/v1/mobile/journals/search":{"get":{"operationId":"mobile_JournalsController_search","parameters":[{"name":"page","required":false,"in":"query","schema":{"minimum":1,"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","schema":{"minimum":1,"maximum":100,"default":20,"type":"number"}},{"name":"q","required":true,"in":"query","description":"Search keyword","schema":{"example":"work","type":"string"}},{"name":"theme","required":false,"in":"query","description":"Filter by theme","schema":{"example":"productivity","type":"string"}}],"responses":{"200":{"description":"Search results returned","content":{"application/json":{"schema":{"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/JournalResponseDto"}},"meta":{"type":"object","properties":{"page":{"type":"number","example":1},"limit":{"type":"number","example":20},"total":{"type":"number","example":42},"hasMore":{"type":"boolean","example":true}}}}}}}},"401":{"description":"Unauthorized"},"403":{"description":"Pro subscription required"}},"security":[{"mobile-jwt":[]}],"summary":"Search journals by keyword (Pro only)","tags":["Journals"]}},"/api/v1/mobile/journals/{id}":{"get":{"operationId":"mobile_JournalsController_findOne","parameters":[{"name":"id","required":true,"in":"path","description":"Journal ID","schema":{"type":"string"}}],"responses":{"200":{"description":"Journal returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JournalResponseDto"}}}},"401":{"description":"Unauthorized"},"404":{"description":"Journal not found"}},"security":[{"mobile-jwt":[]}],"summary":"Get a journal by ID","tags":["Journals"]}},"/api/v1/mobile/insights/mood":{"get":{"operationId":"mobile_InsightsController_getMoodData","parameters":[{"name":"days","required":false,"in":"query","description":"Number of days for mood data","schema":{"default":7,"type":"number","enum":[7,14,30]}}],"responses":{"200":{"description":"Mood data returned successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/MoodDataPointDto"}}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get mood data for the last N days","tags":["Insights"]}},"/api/v1/mobile/insights/themes":{"get":{"operationId":"mobile_InsightsController_getThemes","parameters":[],"responses":{"200":{"description":"Themes returned successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ThemeCountDto"}}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get top themes from last 30 days of journals","tags":["Insights"]}},"/api/v1/mobile/insights/streaks":{"get":{"operationId":"mobile_InsightsController_getStreaks","parameters":[],"responses":{"200":{"description":"Streaks returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/StreaksResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get streak data (current, longest, total check-ins)","tags":["Insights"]}},"/api/v1/mobile/insights/weekly":{"get":{"operationId":"mobile_InsightsController_getWeeklyInsight","parameters":[],"responses":{"200":{"description":"Weekly insight returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MoodInsightResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Pro subscription required"}},"security":[{"mobile-jwt":[]}],"summary":"Get weekly AI insight (Pro only)","tags":["Insights"]}},"/api/v1/mobile/insights/productivity":{"get":{"operationId":"mobile_InsightsController_getProductivity","parameters":[],"responses":{"200":{"description":"Productivity stats returned successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductivityResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Pro subscription required"}},"security":[{"mobile-jwt":[]}],"summary":"Get task productivity stats (Pro only)","tags":["Insights"]}},"/api/v1/mobile/subscriptions/plans":{"get":{"operationId":"mobile_SubscriptionsController_getPlans","parameters":[],"responses":{"200":{"description":"List of active plans","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SubscriptionPlanResponseDto"}}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get all active subscription plans","tags":["Subscriptions"]}},"/api/v1/mobile/subscriptions/status":{"get":{"operationId":"mobile_SubscriptionsController_getStatus","parameters":[],"responses":{"200":{"description":"Subscription status with plan details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubscriptionStatusResponseDto"}}}},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Get current user subscription status","tags":["Subscriptions"]}},"/api/v1/mobile/subscriptions/create":{"post":{"operationId":"mobile_SubscriptionsController_createSubscription","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateSubscriptionDto"}}}},"responses":{"201":{"description":"Subscription created, returns short_url for payment","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateSubscriptionResponseDto"}}}},"400":{"description":"Invalid plan or request"},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Create a new subscription","tags":["Subscriptions"]}},"/api/v1/mobile/subscriptions/verify":{"post":{"operationId":"mobile_SubscriptionsController_verifyPayment","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyPaymentDto"}}}},"responses":{"200":{"description":"Payment verified successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyPaymentResponseDto"}}}},"400":{"description":"Invalid signature or subscription"},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Verify payment after subscription","tags":["Subscriptions"]}},"/api/v1/mobile/subscriptions/cancel":{"post":{"operationId":"mobile_SubscriptionsController_cancelSubscription","parameters":[],"responses":{"200":{"description":"Subscription cancelled","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CancelSubscriptionResponseDto"}}}},"400":{"description":"No active subscription"},"401":{"description":"Unauthorized"}},"security":[{"mobile-jwt":[]}],"summary":"Cancel current subscription","tags":["Subscriptions"]}},"/api/v1/mobile/promo/validate/{code}":{"get":{"operationId":"mobile_PromoCodesController_validate","parameters":[{"name":"code","required":true,"in":"path","description":"Promo code to validate","schema":{"type":"string"}},{"name":"originalPrice","required":false,"in":"query","description":"Original price in paise for discount calculation preview","schema":{"type":"string"}}],"responses":{"200":{"description":"Promo code is valid with discount info","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ValidatePromoResponseDto"}}}},"400":{"description":"Promo expired, inactive, or max uses reached"},"401":{"description":"Unauthorized"},"404":{"description":"Promo code not found"}},"security":[{"mobile-jwt":[]}],"summary":"Validate a promo code","tags":["Promo"]}},"/api/v1/mobile/promo/redeem":{"post":{"operationId":"mobile_PromoCodesController_redeem","parameters":[{"name":"originalPrice","required":true,"in":"query","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RedeemPromoDto"}}}},"responses":{"201":{"description":"Promo code redeemed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RedeemPromoResponseDto"}}}},"400":{"description":"Promo invalid, expired, or max uses reached"},"401":{"description":"Unauthorized"},"404":{"description":"Promo code not found"},"409":{"description":"Promo already redeemed by user"}},"security":[{"mobile-jwt":[]}],"summary":"Redeem a promo code","tags":["Promo"]}},"/api/v1/admin/system/webhooks/{id}/retry":{"post":{"operationId":"mobile_SystemController_retryWebhook","parameters":[{"name":"id","required":true,"in":"path","description":"Webhook event UUID","schema":{"type":"string"}}],"responses":{"200":{"description":"Webhook reprocessed successfully"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - Super Admin required"},"404":{"description":"Webhook event not found"}},"security":[{"admin-jwt":[]}],"summary":"Retry a failed webhook event (Super Admin only)","tags":["Admin System","Admin System"]}}},"info":{"title":"Yapsy Mobile API","description":"API for the Yapsy Flutter mobile application","version":"1.0","contact":{}},"tags":[],"servers":[],"components":{"securitySchemes":{"mobile-jwt":{"scheme":"bearer","bearerFormat":"JWT","type":"http"}},"schemas":{"FirebaseAuthDto":{"type":"object","properties":{"id_token":{"type":"string","description":"Firebase ID token from the client SDK","example":"eyJhbGciOiJSUzI1NiIsImtpZCI6..."}},"required":["id_token"]},"AuthUserDto":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"name":{"type":"object","nullable":true},"avatar_url":{"type":"object","nullable":true},"subscription_status":{"type":"string","enum":["free","pro","cancelled","paused","past_due"]},"is_onboarded":{"type":"boolean","description":"Whether the user has completed onboarding"},"gender":{"type":"string","nullable":true,"enum":["male","female","non_binary","prefer_not_to_say"]},"date_of_birth":{"type":"object","nullable":true}},"required":["id","email","name","avatar_url","subscription_status","is_onboarded","gender","date_of_birth"]},"AuthResponseDto":{"type":"object","properties":{"access_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"refresh_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"user":{"$ref":"#/components/schemas/AuthUserDto"}},"required":["access_token","refresh_token","user"]},"OnboardingDto":{"type":"object","properties":{"name":{"type":"string","description":"User display name","example":"Devansh"},"date_of_birth":{"type":"string","description":"Date of birth (YYYY-MM-DD)","example":"1998-05-15"},"gender":{"type":"string","description":"Gender","enum":["male","female","non_binary","prefer_not_to_say"],"example":"male"},"timezone":{"type":"string","description":"User timezone","example":"Asia/Kolkata"}},"required":["name","date_of_birth","gender"]},"RefreshTokenDto":{"type":"object","properties":{"refresh_token":{"type":"string","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}},"required":["refresh_token"]},"MessageResponseDto":{"type":"object","properties":{"message":{"type":"string","example":"Task deleted"}},"required":["message"]},"AdminAuthResponseDto":{"type":"object","properties":{"access_token":{"type":"string"},"refresh_token":{"type":"string"},"admin":{"type":"object"}},"required":["access_token","refresh_token","admin"]},"UserProfileResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"firebase_uid":{"type":"string"},"email":{"type":"string","example":"user@example.com"},"name":{"type":"object","nullable":true},"avatar_url":{"type":"object","nullable":true},"auth_provider":{"type":"object","nullable":true},"timezone":{"type":"string","example":"Asia/Kolkata"},"is_onboarded":{"type":"boolean"},"date_of_birth":{"type":"object","nullable":true,"format":"date"},"gender":{"type":"string","nullable":true,"enum":["male","female","non_binary","prefer_not_to_say"]},"subscription_status":{"type":"string","enum":["free","pro","cancelled","paused","past_due"]},"razorpay_subscription_id":{"type":"object","nullable":true},"razorpay_customer_id":{"type":"object","nullable":true},"current_streak":{"type":"number","example":5},"total_check_ins":{"type":"number","example":42},"weekly_check_in_count":{"type":"number","example":3},"weekly_check_in_reset_date":{"type":"object","nullable":true,"format":"date"},"last_check_in_date":{"type":"object","nullable":true,"format":"date"},"fcm_token":{"type":"object","nullable":true},"created_at":{"format":"date-time","type":"string"},"updated_at":{"format":"date-time","type":"string"}},"required":["id","firebase_uid","email","timezone","is_onboarded","subscription_status","current_streak","total_check_ins","weekly_check_in_count","created_at","updated_at"]},"UpdateUserDto":{"type":"object","properties":{"name":{"type":"string","description":"User display name"},"avatar_url":{"type":"string","description":"Avatar URL"},"timezone":{"type":"string","description":"User timezone (e.g. Asia/Kolkata)"}}},"UpdateFcmTokenDto":{"type":"object","properties":{"fcm_token":{"type":"string","description":"Firebase Cloud Messaging token for push notifications"}},"required":["fcm_token"]},"UpdateSubscriptionDto":{"type":"object","properties":{"subscription_status":{"type":"string","enum":["free","pro","cancelled","paused","past_due"],"description":"Subscription status"}},"required":["subscription_status"]},"TaskResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"user_id":{"type":"string","format":"uuid"},"title":{"type":"string","example":"Buy groceries"},"description":{"type":"object","example":"Milk, eggs, bread","nullable":true},"scheduled_date":{"type":"string","example":"2026-02-15","format":"date"},"status":{"type":"string","enum":["pending","completed","rolled_over","cancelled"],"example":"pending"},"priority":{"type":"string","enum":["low","medium","high"],"example":"medium"},"rolled_from_id":{"type":"object","format":"uuid","nullable":true},"completed_at":{"type":"object","nullable":true,"format":"date-time"},"source":{"type":"object","nullable":true,"example":"voice"},"created_at":{"format":"date-time","type":"string"},"updated_at":{"format":"date-time","type":"string"}},"required":["id","user_id","title","scheduled_date","status","priority","created_at","updated_at"]},"CreateTaskDto":{"type":"object","properties":{"title":{"type":"string","description":"Task title","example":"Buy groceries"},"description":{"type":"string","description":"Task description"},"scheduled_date":{"type":"string","description":"Scheduled date","example":"2026-02-20"},"priority":{"type":"string","enum":["low","medium","high"]},"source":{"type":"string","description":"Task source","default":"manual"}},"required":["title","scheduled_date"]},"UpdateTaskDto":{"type":"object","properties":{"title":{"type":"string","description":"Task title"},"description":{"type":"string","description":"Task description"},"scheduled_date":{"type":"string","description":"Scheduled date","example":"2026-02-20"},"priority":{"type":"string","enum":["low","medium","high"]},"status":{"type":"string","enum":["pending","completed","rolled_over","cancelled"]}}},"RolloverTaskDto":{"type":"object","properties":{"new_date":{"type":"string","description":"New date for the rolled-over task","example":"2026-02-21"}},"required":["new_date"]},"NoteResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"user_id":{"type":"string","format":"uuid"},"content":{"type":"string","example":"Remember to follow up on the meeting"},"follow_up_date":{"type":"object","nullable":true,"format":"date","example":"2026-02-20"},"is_resolved":{"type":"boolean","example":false},"source":{"type":"object","nullable":true,"example":"voice"},"journal_id":{"type":"object","nullable":true,"format":"uuid"},"created_at":{"format":"date-time","type":"string"},"updated_at":{"format":"date-time","type":"string"}},"required":["id","user_id","content","is_resolved","created_at","updated_at"]},"CreateNoteDto":{"type":"object","properties":{"content":{"type":"string","description":"Note content","example":"Call dentist tomorrow"},"follow_up_date":{"type":"string","description":"Follow-up date","example":"2026-02-20"},"source":{"type":"string","description":"Note source","enum":["voice","manual"],"default":"manual"}},"required":["content"]},"UpdateNoteDto":{"type":"object","properties":{"content":{"type":"string","description":"Note content"},"follow_up_date":{"type":"string","description":"Follow-up date","example":"2026-02-20"},"is_resolved":{"type":"boolean","description":"Whether the note is resolved"}}},"PrepareSessionResponseDto":{"type":"object","properties":{"signed_url":{"type":"string","example":"https://api.elevenlabs.io/v1/..."},"session_config":{"type":"object","additionalProperties":true,"example":{"agent_id":"abc123"}}},"required":["signed_url","session_config"]},"TranscriptMessageDto":{"type":"object","properties":{"role":{"type":"string","description":"Role (user/assistant)","example":"user"},"text":{"type":"string","description":"Message text","example":"Hello"},"timestamp":{"type":"number","description":"Timestamp in seconds","example":0}},"required":["role","text","timestamp"]},"SaveConversationDto":{"type":"object","properties":{"conversation_id":{"type":"string","description":"ElevenLabs conversation ID","example":"conv_abc123"},"transcript":{"description":"Transcript array","example":[{"role":"user","text":"Hello","timestamp":0},{"role":"assistant","text":"Hi there!","timestamp":1}],"type":"array","items":{"$ref":"#/components/schemas/TranscriptMessageDto"}},"duration_seconds":{"type":"number","description":"Duration in seconds","example":120},"date":{"type":"string","description":"Date of conversation (defaults to today)","example":"2026-02-15"}},"required":["conversation_id","transcript","duration_seconds"]},"JournalResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"user_id":{"type":"string","format":"uuid"},"date":{"type":"string","example":"2026-02-15","format":"date"},"elevenlabs_conversation_id":{"type":"object","nullable":true},"duration_seconds":{"type":"number","example":120},"transcript":{"type":"array","items":{"type":"object"},"example":[]},"summary":{"type":"object","nullable":true,"example":"Had a productive day..."},"mood_score":{"type":"object","nullable":true,"example":8},"mood_label":{"type":"object","nullable":true,"example":"happy"},"themes":{"example":["work","health"],"type":"array","items":{"type":"string"}},"wins":{"example":["Finished project"],"type":"array","items":{"type":"string"}},"struggles":{"example":["Felt tired"],"type":"array","items":{"type":"string"}},"people_mentioned":{"example":["John"],"type":"array","items":{"type":"string"}},"concern_level":{"type":"string","enum":["low","medium","high"],"example":"low"},"actions_taken":{"type":"array","items":{"type":"object"},"example":[]},"processing_status":{"type":"string","example":"completed"},"created_at":{"format":"date-time","type":"string"},"updated_at":{"format":"date-time","type":"string"}},"required":["id","user_id","date","duration_seconds","transcript","themes","wins","struggles","people_mentioned","concern_level","actions_taken","processing_status","created_at","updated_at"]},"ProcessingStatusResponseDto":{"type":"object","properties":{"processing_status":{"type":"string","example":"completed","enum":["pending","processing","completed","failed"]}},"required":["processing_status"]},"JournalStatsResponseDto":{"type":"object","properties":{"entries":{"type":"array","items":{"$ref":"#/components/schemas/JournalResponseDto"}},"avg_mood":{"type":"number","example":7.5},"total_entries":{"type":"number","example":15}},"required":["entries","avg_mood","total_entries"]},"MoodDataPointDto":{"type":"object","properties":{"date":{"type":"string","example":"2026-02-15","format":"date"},"mood_score":{"type":"object","nullable":true,"example":8},"mood_label":{"type":"object","nullable":true,"example":"happy"}},"required":["date"]},"ThemeCountDto":{"type":"object","properties":{"theme":{"type":"string","example":"work"},"count":{"type":"number","example":5}},"required":["theme","count"]},"StreaksResponseDto":{"type":"object","properties":{"current_streak":{"type":"number","example":7},"longest_streak":{"type":"number","example":14},"total_check_ins":{"type":"number","example":42}},"required":["current_streak","longest_streak","total_check_ins"]},"MoodInsightResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"user_id":{"type":"string","format":"uuid"},"week_start":{"type":"string","format":"date","example":"2026-02-10"},"avg_mood":{"type":"object","nullable":true,"example":7.5},"mood_trend":{"type":"string","nullable":true,"enum":["improving","stable","declining"]},"top_themes":{"example":["work","health","family"],"type":"array","items":{"type":"string"}},"productivity_score":{"type":"object","nullable":true,"example":85},"insight_text":{"type":"object","nullable":true,"example":"This week you showed improvement in..."},"created_at":{"format":"date-time","type":"string"}},"required":["id","user_id","week_start","top_themes","created_at"]},"ProductivityPeriodDto":{"type":"object","properties":{"completed":{"type":"number","example":8},"total":{"type":"number","example":10},"rate":{"type":"number","example":80,"description":"Completion rate percentage"}},"required":["completed","total","rate"]},"ProductivityResponseDto":{"type":"object","properties":{"week":{"$ref":"#/components/schemas/ProductivityPeriodDto"},"two_weeks":{"$ref":"#/components/schemas/ProductivityPeriodDto"},"month":{"$ref":"#/components/schemas/ProductivityPeriodDto"}},"required":["week","two_weeks","month"]},"SubscriptionPlanResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"name":{"type":"string","example":"Pro Monthly"},"razorpay_plan_id":{"type":"object","nullable":true},"price_amount":{"type":"number","example":29900,"description":"Price in paise"},"currency":{"type":"string","example":"INR"},"interval":{"type":"string","enum":["monthly","yearly"]},"features":{"type":"object","additionalProperties":true,"example":{}},"is_active":{"type":"boolean","example":true},"created_at":{"format":"date-time","type":"string"},"updated_at":{"format":"date-time","type":"string"}},"required":["id","name","price_amount","currency","interval","features","is_active","created_at","updated_at"]},"SubscriptionStatusPlanDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"name":{"type":"string","example":"Pro Monthly"},"price_amount":{"type":"number","example":29900},"currency":{"type":"string","example":"INR"},"interval":{"type":"string","enum":["monthly","yearly"]},"features":{"type":"object","additionalProperties":true}},"required":["id","name","price_amount","currency","interval","features"]},"SubscriptionStatusResponseDto":{"type":"object","properties":{"subscription_status":{"type":"string","enum":["free","pro","cancelled","paused","past_due"]},"razorpay_subscription_id":{"type":"object","nullable":true},"plan":{"nullable":true,"allOf":[{"$ref":"#/components/schemas/SubscriptionStatusPlanDto"}]}},"required":["subscription_status"]},"CreateSubscriptionDto":{"type":"object","properties":{"plan_id":{"type":"string","description":"Subscription plan UUID"},"promo_code":{"type":"string","description":"Promo code for discount"}},"required":["plan_id"]},"CreateSubscriptionResponseDto":{"type":"object","properties":{"subscription_id":{"type":"string","example":"sub_abc123"},"short_url":{"type":"string","example":"https://rzp.io/i/abc123"},"status":{"type":"string","example":"created"}},"required":["subscription_id","short_url","status"]},"VerifyPaymentDto":{"type":"object","properties":{"razorpay_payment_id":{"type":"string","description":"Razorpay payment ID"},"razorpay_subscription_id":{"type":"string","description":"Razorpay subscription ID"},"razorpay_signature":{"type":"string","description":"Razorpay signature for verification"}},"required":["razorpay_payment_id","razorpay_subscription_id","razorpay_signature"]},"VerifyPaymentResponseDto":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Payment verified successfully"}},"required":["success","message"]},"CancelSubscriptionResponseDto":{"type":"object","properties":{"success":{"type":"boolean","example":true},"message":{"type":"string","example":"Subscription cancelled"}},"required":["success","message"]},"CreatePlanDto":{"type":"object","properties":{"name":{"type":"string","description":"Plan name","example":"Pro Monthly"},"price_amount":{"type":"number","description":"Price in paise","example":99900},"currency":{"type":"string","description":"Currency code","default":"INR"},"interval":{"type":"string","description":"Billing interval","enum":["monthly","yearly"]},"features":{"type":"object","description":"Plan features as key-value pairs"},"is_active":{"type":"boolean","description":"Whether plan is active","default":true}},"required":["name","price_amount","interval"]},"UpdatePlanDto":{"type":"object","properties":{"name":{"type":"string","description":"Plan name","example":"Pro Monthly"},"price_amount":{"type":"number","description":"Price in paise","example":99900},"currency":{"type":"string","description":"Currency code","default":"INR"},"interval":{"type":"string","description":"Billing interval","enum":["monthly","yearly"]},"features":{"type":"object","description":"Plan features as key-value pairs"},"is_active":{"type":"boolean","description":"Whether plan is active","default":true}}},"PromoCodeResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"code":{"type":"string","example":"WELCOME50"},"type":{"type":"string","enum":["percentage","flat","set_price"]},"value":{"type":"number","example":50},"duration_months":{"type":"object","nullable":true,"example":3},"max_uses":{"type":"object","nullable":true,"example":100},"current_uses":{"type":"number","example":5},"valid_from":{"format":"date-time","type":"string"},"valid_until":{"type":"object","nullable":true,"format":"date-time"},"is_active":{"type":"boolean","example":true},"created_at":{"format":"date-time","type":"string"},"updated_at":{"format":"date-time","type":"string"}},"required":["id","code","type","value","current_uses","valid_from","is_active","created_at","updated_at"]},"ValidatePromoResponseDto":{"type":"object","properties":{"promo":{"$ref":"#/components/schemas/PromoCodeResponseDto"},"discountAmount":{"type":"number","example":14950,"description":"Discount amount in paise"},"finalPrice":{"type":"number","example":14950,"description":"Final price after discount in paise"}},"required":["promo","discountAmount","finalPrice"]},"RedeemPromoDto":{"type":"object","properties":{"code":{"type":"string","description":"Promo code to redeem","example":"SAVE20"}},"required":["code"]},"UserPromoRedemptionResponseDto":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"user_id":{"type":"string","format":"uuid"},"promo_code_id":{"type":"string","format":"uuid"},"redeemed_at":{"format":"date-time","type":"string"},"effective_until":{"type":"object","nullable":true,"format":"date-time"}},"required":["id","user_id","promo_code_id","redeemed_at"]},"RedeemPromoResponseDto":{"type":"object","properties":{"redemption":{"$ref":"#/components/schemas/UserPromoRedemptionResponseDto"},"discountAmount":{"type":"number","example":14950},"finalPrice":{"type":"number","example":14950},"effectiveUntil":{"format":"date-time","type":"string"}},"required":["redemption","discountAmount","finalPrice","effectiveUntil"]},"CreatePromoDto":{"type":"object","properties":{"code":{"type":"string","description":"Promo code (stored uppercase)","example":"SAVE20"},"type":{"type":"string","enum":["percentage","flat","set_price"],"description":"Discount type"},"value":{"type":"number","description":"Value: percentage (1-100), flat amount in paise, or set price in paise","example":20},"duration_months":{"type":"number","description":"Subscription duration in months when redeemed","example":12},"max_uses":{"type":"number","description":"Maximum number of redemptions allowed","example":100},"valid_from":{"type":"string","description":"Valid from date (ISO 8601)","example":"2026-01-01T00:00:00.000Z"},"valid_until":{"type":"string","description":"Valid until date (ISO 8601)","example":"2026-12-31T23:59:59.000Z"},"is_active":{"type":"boolean","description":"Whether the promo is active","default":true}},"required":["code","type","value","valid_from"]},"UpdatePromoDto":{"type":"object","properties":{"code":{"type":"string","description":"Promo code (stored uppercase)","example":"SAVE20"},"type":{"type":"string","enum":["percentage","flat","set_price"],"description":"Discount type"},"value":{"type":"number","description":"Value: percentage (1-100), flat amount in paise, or set price in paise","example":20},"duration_months":{"type":"number","description":"Subscription duration in months when redeemed","example":12},"max_uses":{"type":"number","description":"Maximum number of redemptions allowed","example":100},"valid_from":{"type":"string","description":"Valid from date (ISO 8601)","example":"2026-01-01T00:00:00.000Z"},"valid_until":{"type":"string","description":"Valid until date (ISO 8601)","example":"2026-12-31T23:59:59.000Z"},"is_active":{"type":"boolean","description":"Whether the promo is active","default":true}}},"CreateAdminDto":{"type":"object","properties":{"email":{"type":"string","description":"Admin email (must match a Firebase account)","example":"admin@yapsy.app"},"name":{"type":"string","description":"Display name","example":"Jane Doe"},"role":{"type":"string","description":"Admin role","enum":["super_admin","moderator"],"default":"moderator"}},"required":["email","name"]},"UpdateAdminRoleDto":{"type":"object","properties":{"role":{"type":"string","description":"New admin role","enum":["super_admin","moderator"]}},"required":["role"]}}}}